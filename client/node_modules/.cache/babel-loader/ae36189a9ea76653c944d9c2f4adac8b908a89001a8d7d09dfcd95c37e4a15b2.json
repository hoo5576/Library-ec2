{"ast":null,"code":"// React에서 useState 및 useEffect를 가져옵니다\nimport React,{useEffect,useState}from'react';import{NavLink,useLocation,useParams}from'react-router-dom';import'slick-carousel/slick/slick.css';import'slick-carousel/slick/slick-theme.css';import{Box,Pagination}from'@mui/material';import'./BookSearch.scss';import axios from'axios';import{API_URL}from'../../../config/contansts';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const BookSearch=()=>{// const {search} = useLocation();\nconst{search}=useParams();const[showWelcome,setShowWelcome]=useState(false);const[currentPage,setCurrentPage]=useState(1);const itemsPerPage=5;// const [genre, setGenre] = useState(decodeURI(search.split('=')[1]));\nconst[books,setBooks]=useState([]);// console.log(\"url: \", genre);\nconsole.log(\"url: \",search);useEffect(()=>{const timeout=setTimeout(()=>{setShowWelcome(true);},500);window.scrollTo(0,0);return()=>clearTimeout(timeout);},[]);useEffect(()=>{// 데이터베이스에서 도서 목록을 가져오는 로직\naxios.get(\"\".concat(API_URL,\"/api/book/search/\").concat(search)).then(res=>{setBooks(res.data);console.log(\"관련 도서:\",res.data);}).catch(err=>{setBooks([]);console.error(err);});},[search]);// 현재 페이지에 표시할 데이터 계산\nconst indexOfLastItem=currentPage*itemsPerPage;const indexOfFirstItem=indexOfLastItem-itemsPerPage;// 페이지 변경 함수\nconst handlePageChange=(event,pageNumber)=>{setCurrentPage(pageNumber);};return/*#__PURE__*/_jsx(\"div\",{className:\"BookSearch-container-lhs \".concat(showWelcome?'show':''),children:/*#__PURE__*/_jsxs(\"div\",{className:\"BookList-content-lhs \".concat(showWelcome?'show':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"BookList-SF-welcome-lhs \".concat(showWelcome?'visible':'')}),/*#__PURE__*/_jsxs(\"div\",{className:\"BookList-content-lhs\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uC5F0\\uAD00 \\uB3C4\\uC11C\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"BookList-main-content-lhs  \".concat(showWelcome?'show':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"BookList-main-img-lhs\",children:books.length>0?books.slice(indexOfFirstItem,indexOfLastItem).map((item,index)=>{return/*#__PURE__*/_jsx(NavLink,{to:\"/BookDetail/\".concat(item.book_id),className:\"grid-item-lhs \".concat(item.book_availability==='대출 가능'?'available':'unavailable'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid-item-info-lhs\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"book-image-lhs\",children:/*#__PURE__*/_jsx(\"img\",{src:API_URL+item.book_img_url,alt:\"grid\".concat(index+1)})}),/*#__PURE__*/_jsxs(\"div\",{className:\"book-details-lhs\",children:[item.book_availability==1?/*#__PURE__*/_jsx(\"div\",{className:\"book-detail-availability-lhs\",style:{backgroundColor:\"blue\"},children:/*#__PURE__*/_jsx(\"span\",{children:\" \\uB300\\uCD9C \\uAC00\\uB2A5 \"})}):/*#__PURE__*/_jsx(\"div\",{className:\"book-detail-availability-lhs\",style:{backgroundColor:\"red\"},children:/*#__PURE__*/_jsx(\"span\",{children:\" \\uB300\\uCD9C \\uBD88\\uAC00 \"})}),/*#__PURE__*/_jsx(\"h3\",{children:item.book_name}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uC800\\uC790:\"}),\" \",item.book_author]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uCD9C\\uD310\\uC0AC:\"}),\" \",item.book_publisher]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uCD9C\\uD310\\uC77C:\"}),\" \",item.created_at]}),/*#__PURE__*/_jsxs(\"div\",{className:\"book-rating-lhs\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"book-rating-name\",children:\"\\uD3C9\\uC810:\"}),item.average_rating?Array.from({length:item.average_rating},(_,index)=>/*#__PURE__*/_jsx(\"span\",{className:\"star-icon\",children:\"\\u2605\"},index)):/*#__PURE__*/_jsx(\"span\",{className:\"book-rating-name\",children:\"\\uD3C9\\uC810 \\uC5C6\\uC74C\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"book-description-lhs\",children:item.book_description})]})]})},index);}):/*#__PURE__*/_jsxs(\"h1\",{className:\"\",children:[\"\\\"\",search,\"\\\"\\uC5D0 \\uB300\\uD55C \\uAC80\\uC0C9\\uACB0\\uACFC\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"pagination-container-lhs\",style:{margin:\"0 auto\"},children:/*#__PURE__*/_jsx(Box,{display:\"flex\",justifyContent:\"center\",alignItems:\"center\",children:/*#__PURE__*/_jsx(Pagination,{count:Math.ceil(books.length/itemsPerPage),page:currentPage,onChange:handlePageChange,variant:\"outlined\",shape:\"rounded\"})})})]})]})]})});};export default BookSearch;","map":{"version":3,"names":["React","useEffect","useState","NavLink","useLocation","useParams","Box","Pagination","axios","API_URL","jsx","_jsx","jsxs","_jsxs","BookSearch","search","showWelcome","setShowWelcome","currentPage","setCurrentPage","itemsPerPage","books","setBooks","console","log","timeout","setTimeout","window","scrollTo","clearTimeout","get","concat","then","res","data","catch","err","error","indexOfLastItem","indexOfFirstItem","handlePageChange","event","pageNumber","className","children","length","slice","map","item","index","to","book_id","book_availability","src","book_img_url","alt","style","backgroundColor","book_name","book_author","book_publisher","created_at","average_rating","Array","from","_","book_description","margin","display","justifyContent","alignItems","count","Math","ceil","page","onChange","variant","shape"],"sources":["C:/Users/user/Desktop/Library-ec2/client/src/pages/Book/BookSearch/BookSearch.js"],"sourcesContent":["// React에서 useState 및 useEffect를 가져옵니다\r\nimport React, { useEffect, useState } from 'react';\r\nimport { NavLink, useLocation, useParams } from 'react-router-dom';\r\nimport 'slick-carousel/slick/slick.css';\r\nimport 'slick-carousel/slick/slick-theme.css';\r\nimport { Box, Pagination } from '@mui/material';\r\nimport './BookSearch.scss';\r\nimport axios from 'axios';\r\nimport { API_URL } from '../../../config/contansts';\r\n\r\nconst BookSearch = () => {\r\n  // const {search} = useLocation();\r\n  const { search } = useParams();\r\n  const [showWelcome, setShowWelcome] = useState(false);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const itemsPerPage = 5;\r\n  // const [genre, setGenre] = useState(decodeURI(search.split('=')[1]));\r\n  const [books, setBooks] = useState([]);\r\n  // console.log(\"url: \", genre);\r\n  console.log(\"url: \", search);\r\n\r\n  useEffect(() => {\r\n    const timeout = setTimeout(() => {\r\n      setShowWelcome(true);\r\n    }, 500);\r\n\r\n    window.scrollTo(0, 0);\r\n\r\n    return () => clearTimeout(timeout);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    // 데이터베이스에서 도서 목록을 가져오는 로직\r\n    axios.get(`${API_URL}/api/book/search/${search}`)\r\n      .then(res => {\r\n        setBooks(res.data);\r\n        console.log(\"관련 도서:\", res.data);\r\n      })\r\n      .catch(err => {\r\n        setBooks([]);\r\n        console.error(err);\r\n      });\r\n  }, [search]);\r\n\r\n  // 현재 페이지에 표시할 데이터 계산\r\n  const indexOfLastItem = currentPage * itemsPerPage;\r\n  const indexOfFirstItem = indexOfLastItem - itemsPerPage;\r\n\r\n  // 페이지 변경 함수\r\n  const handlePageChange = (event, pageNumber) => {\r\n    setCurrentPage(pageNumber);\r\n  };\r\n\r\n  return (\r\n    <div className={`BookSearch-container-lhs ${showWelcome ? 'show' : ''}`}>\r\n      <div className={`BookList-content-lhs ${showWelcome ? 'show' : ''}`}>\r\n        <div className={`BookList-SF-welcome-lhs ${showWelcome ? 'visible' : ''}`}></div>\r\n        <div className='BookList-content-lhs'>\r\n          <h2>연관 도서</h2>\r\n          <div className={`BookList-main-content-lhs  ${showWelcome ? 'show' : ''}`}>\r\n            <div className='BookList-main-img-lhs'>\r\n              {books.length > 0 ? \r\n                books.slice(indexOfFirstItem,indexOfLastItem).map((item, index) => {\r\n                return (\r\n                  <NavLink to={`/BookDetail/${item.book_id}`} key={index} className={`grid-item-lhs ${item.book_availability === '대출 가능' ? 'available' : 'unavailable'}`}>\r\n                    <div className='grid-item-info-lhs'>\r\n                      <div className='book-image-lhs'>\r\n                        <img src={API_URL + item.book_img_url} alt={`grid${index + 1}`} />\r\n                      </div>\r\n                      <div className='book-details-lhs'>\r\n                          {item.book_availability == 1? \r\n                            <div className='book-detail-availability-lhs' style={{backgroundColor: \"blue\"}}> \r\n                              <span> 대출 가능 </span>\r\n                            </div> \r\n                            : \r\n                            <div className='book-detail-availability-lhs' style={{backgroundColor: \"red\"}}> \r\n                              <span> 대출 불가 </span>\r\n                            </div> \r\n                          }\r\n                        <h3>{item.book_name}</h3>\r\n                        <p><span>저자:</span> {item.book_author}</p>\r\n                        <p><span>출판사:</span> {item.book_publisher}</p>\r\n                        <p><span>출판일:</span> {item.created_at}</p>\r\n                        <div className='book-rating-lhs'>\r\n                          <span className='book-rating-name'>평점:</span>\r\n                          {item.average_rating ? (\r\n                            Array.from({ length: item.average_rating }, (_, index) => (\r\n                              <span key={index} className=\"star-icon\">★</span>\r\n                            ))\r\n                          ) : (\r\n                            <span className='book-rating-name'>평점 없음</span>\r\n                          )}\r\n                        </div>\r\n                        <p className='book-description-lhs'>{item.book_description}</p>\r\n                      </div>\r\n                    </div>\r\n                  </NavLink>\r\n                );\r\n              })\r\n              :\r\n              <h1 className=''>\"{search}\"에 대한 검색결과가 없습니다.</h1>\r\n              }\r\n            </div>\r\n            <div className=\"pagination-container-lhs\" style={{ margin: \"0 auto\" }}>\r\n              <Box display=\"flex\" justifyContent=\"center\" alignItems=\"center\">\r\n                <Pagination\r\n                  count={Math.ceil(books.length / itemsPerPage)}\r\n                  page={currentPage}\r\n                  onChange={handlePageChange}\r\n                  variant=\"outlined\"\r\n                  shape=\"rounded\"\r\n                />\r\n              </Box>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BookSearch;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}