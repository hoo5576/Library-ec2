{"ast":null,"code":"import React,{useState,useEffect}from'react';import{NavLink}from'react-router-dom';import'./LoansTable.scss';import axios from'axios';import{API_URL}from'../../../config/contansts';import LoansRow from'../LoansRow/LoansRow';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const LoansTable=_ref=>{let{is_returned}=_ref;console.log(is_returned);const[showAllBooks,setShowAllBooks]=useState(false);// 간략히 보기 버튼 표시 여부\nconst[showBriefView,setShowBriefView]=useState(false);// 더보기 버튼 표시 여부\nconst[userbyLoans,setUserbyLoans]=useState([]);//DB에서 불러온 데이터\nconst[showMoreData,setShowMoreData]=useState(3);//더보기 버튼 눌렀을 때 몇개씩 더 나타나게\n/** 받은 유저id로 유저 대출정보 조회요청 */useEffect(()=>{axios.get(\"\".concat(API_URL,\"/api/loans/userbyloans\")).then(res=>{console.log(\"res: \",res);let loansBooks=null;if(is_returned){loansBooks=res.data.filter(loans=>loans.deletedAt!=null);}else{loansBooks=res.data.filter(loans=>loans.deletedAt==null);}setUserbyLoans(loansBooks);console.log(\"대출한 책 : \",loansBooks);}).catch(err=>{console.error(err);});},[]);const toggleShowAllBooks=()=>{//더보기 버튼 클릭 시 이벤트 \nsetShowAllBooks(!showAllBooks);//간략히 보기 버튼 표시 여부 반전\nsetShowBriefView(false);// 더보기 버튼 안보이게\nsetShowMoreData(3);// 더보기를 누를 때 초기화\n};const toggleShowBriefView=()=>{// 간략히 보기 버튼 클릭시 이벤트\nsetShowBriefView(!showBriefView);//더보기 버튼 표시 여부 반전\nsetShowAllBooks(false);// \"더보기\"를 누르면 간략히 보기가 해제되도록 추가\n// setShowMoreData(3); // 간략히 보기를 누를 때 초기화\n};// const visibleBooks = showAllBooks ? userbyLoans : (showBriefView ? userbyLoans.slice(0, 3) : userbyLoans.slice(0, 3));  \nconst visibleBooks=showAllBooks?userbyLoans:userbyLoans.slice(0,showMoreData);const handleShowMore=()=>{setShowMoreData(prevShowMoreData=>prevShowMoreData+3);};const handleShowBriefView=()=>{setShowMoreData(3);};return/*#__PURE__*/_jsxs(\"div\",{className:\"rentTable-kjh\",children:[/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"5\",className:\"tdTitle-kjh\",children:is_returned?\"내가 봤던 책\":\"대여 중인 책\"})}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"tdsubTitle-kjh\",children:\"\\uC791\\uAC00\"}),/*#__PURE__*/_jsx(\"td\",{className:\"tdsubTitle-kjh\",children:\"\\uCC45 \\uC81C\\uBAA9\"}),/*#__PURE__*/_jsx(\"td\",{className:\"tdsubTitle-kjh\",children:\"\\uB300\\uC5EC\\uC2DC\\uC791\\uC77C\"}),/*#__PURE__*/_jsx(\"td\",{className:\"tdsubTitle-kjh\",children:\"\\uBC18\\uB0A9\\uC77C\"}),/*#__PURE__*/_jsx(\"td\",{className:\"tdsubTitle-kjh\",children:\"\\uBC18\\uB0A9\\uC77C\"})]}),visibleBooks.map((book,index)=>/*#__PURE__*/_jsx(LoansRow,{book:book,index:index}))]}),showMoreData<userbyLoans.length&&/*#__PURE__*/_jsxs(NavLink,{onClick:handleShowMore,className:\"more-kjh\",children:[\"\\uB354\\uBCF4\\uAE30 \",'>']}),showMoreData>=userbyLoans.length&&/*#__PURE__*/_jsxs(NavLink,{onClick:handleShowBriefView,className:\"more-kjh\",children:[\"\\uAC04\\uB7B5\\uD788 \\uBCF4\\uAE30 \",'>']}),showAllBooks&&/*#__PURE__*/_jsxs(NavLink,{onClick:toggleShowBriefView,className:\"more-kjh\",children:[\"\\uAC04\\uB7B5\\uD788 \\uBCF4\\uAE30 \",'>']}),showBriefView&&/*#__PURE__*/_jsxs(NavLink,{onClick:toggleShowAllBooks,className:\"more-kjh\",children:[\"\\uB354\\uBCF4\\uAE30 \",'>']})]});};export default LoansTable;","map":{"version":3,"names":["React","useState","useEffect","NavLink","axios","API_URL","LoansRow","jsx","_jsx","jsxs","_jsxs","LoansTable","_ref","is_returned","console","log","showAllBooks","setShowAllBooks","showBriefView","setShowBriefView","userbyLoans","setUserbyLoans","showMoreData","setShowMoreData","get","concat","then","res","loansBooks","data","filter","loans","deletedAt","catch","err","error","toggleShowAllBooks","toggleShowBriefView","visibleBooks","slice","handleShowMore","prevShowMoreData","handleShowBriefView","className","children","colSpan","map","book","index","length","onClick"],"sources":["C:/Users/user/Desktop/Library-ec2/client/src/components/Mypage/LoansTable/LoansTable.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { NavLink } from 'react-router-dom';\r\nimport './LoansTable.scss';\r\nimport axios from 'axios';\r\nimport { API_URL } from '../../../config/contansts';\r\nimport LoansRow from '../LoansRow/LoansRow';\r\n\r\nconst LoansTable = ({is_returned}) => {\r\n  console.log(is_returned);\r\n  const [showAllBooks, setShowAllBooks] = useState(false); // 간략히 보기 버튼 표시 여부\r\n  const [showBriefView, setShowBriefView] = useState(false); // 더보기 버튼 표시 여부\r\n  const [userbyLoans, setUserbyLoans] = useState([]); //DB에서 불러온 데이터\r\n  const [showMoreData, setShowMoreData] = useState(3); //더보기 버튼 눌렀을 때 몇개씩 더 나타나게\r\n\r\n   /** 받은 유저id로 유저 대출정보 조회요청 */\r\n  useEffect(() => {\r\n    axios.get(`${API_URL}/api/loans/userbyloans`)\r\n      .then(res => {\r\n        console.log(\"res: \", res);\r\n        let loansBooks = null;\r\n        if(is_returned){\r\n          loansBooks = res.data.filter(loans => loans.deletedAt != null);\r\n        }else {\r\n          loansBooks = res.data.filter(loans => loans.deletedAt == null);\r\n        }\r\n        setUserbyLoans(loansBooks);\r\n        console.log(\"대출한 책 : \", loansBooks);\r\n      })\r\n      .catch((err) => {\r\n        console.error(err);\r\n      });\r\n  }, []);\r\n\r\n  const toggleShowAllBooks = () => { //더보기 버튼 클릭 시 이벤트 \r\n    setShowAllBooks(!showAllBooks); //간략히 보기 버튼 표시 여부 반전\r\n    setShowBriefView(false); // 더보기 버튼 안보이게\r\n    setShowMoreData(3); // 더보기를 누를 때 초기화\r\n  };\r\n  const toggleShowBriefView = () => { // 간략히 보기 버튼 클릭시 이벤트\r\n    setShowBriefView(!showBriefView); //더보기 버튼 표시 여부 반전\r\n    setShowAllBooks(false); // \"더보기\"를 누르면 간략히 보기가 해제되도록 추가\r\n    // setShowMoreData(3); // 간략히 보기를 누를 때 초기화\r\n  };\r\n  // const visibleBooks = showAllBooks ? userbyLoans : (showBriefView ? userbyLoans.slice(0, 3) : userbyLoans.slice(0, 3));  \r\n  const visibleBooks = showAllBooks ? userbyLoans : userbyLoans.slice(0, showMoreData);  \r\n  const handleShowMore = () => {\r\n    setShowMoreData(prevShowMoreData => prevShowMoreData + 3);\r\n  };\r\n  const handleShowBriefView = () => {\r\n    setShowMoreData(3);\r\n  };\r\n \r\n  return (\r\n    <div className='rentTable-kjh'>\r\n      <table>\r\n        <tr>\r\n          <td colSpan='5' className='tdTitle-kjh'>\r\n            {is_returned ? \"내가 봤던 책\" : \"대여 중인 책\"}\r\n          </td>\r\n        </tr>\r\n        <tr>\r\n          <td className='tdsubTitle-kjh'>작가</td>\r\n          <td className='tdsubTitle-kjh'>책 제목</td>\r\n          <td className='tdsubTitle-kjh'>대여시작일</td>\r\n          <td className='tdsubTitle-kjh'>반납일</td>\r\n          <td className='tdsubTitle-kjh'>반납일</td>\r\n        </tr>\r\n        {visibleBooks.map((book, index) => (\r\n          <LoansRow \r\n            book={book} \r\n            index={index}\r\n          />\r\n        ))}\r\n  \r\n      </table>\r\n      {showMoreData < userbyLoans.length && (\r\n        <NavLink onClick={handleShowMore} className='more-kjh'>더보기 {'>'}</NavLink>\r\n      )}\r\n      {/* {!showAllBooks && !showBriefView && (\r\n        <NavLink onClick={toggleShowAllBooks} className='more-kjh'>더보기 {'>'}</NavLink>\r\n      )} */}\r\n      {showMoreData >= userbyLoans.length && (\r\n        <NavLink onClick={handleShowBriefView} className='more-kjh'>간략히 보기 {'>'}</NavLink>\r\n      )}\r\n      {showAllBooks && (\r\n        <NavLink onClick={toggleShowBriefView} className='more-kjh'>간략히 보기 {'>'}</NavLink>\r\n      )}\r\n      {showBriefView && (\r\n        <NavLink onClick={toggleShowAllBooks} className='more-kjh'>더보기 {'>'}</NavLink>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nexport default LoansTable;\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}