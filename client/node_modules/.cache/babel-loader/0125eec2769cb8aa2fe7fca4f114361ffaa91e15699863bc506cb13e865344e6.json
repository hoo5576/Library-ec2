{"ast":null,"code":"import React,{useState,useEffect}from'react';import'./Review.scss';import axios from'axios';import{NavLink,useParams,useNavigate}from'react-router-dom';import{API_URL}from'../../../config/contansts';import BasicRating from'../../../components/Rating/BasicRating';import{errHandler}from\"../../../utils/globalFunction\";import{useRecoilState}from\"recoil\";import{loginState}from\"../../../recoil/atoms/State\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Review=()=>{const navigate=useNavigate();const[islogin,setIslogin]=useRecoilState(loginState);//useState와 거의 비슷한 사용법\nconst{id}=useParams();const[book,setBook]=useState({});const[reviewValue,setReviewValue]=useState({reviewTitle:'',reviewContent:''});const[ratingValue,setRatingValue]=useState(0);useEffect(()=>{axios.get(\"\".concat(API_URL,\"/api/book?book_id=\").concat(id)).then(res=>{console.log(\"setBook : \",res.data[0]);setBook(res.data[0]);}).catch(err=>{console.error(err);});},[]);const handleSubmit=async()=>{console.log(\"reviewValue : \",reviewValue);console.log(\"ratingValue : \",ratingValue);const reviewData={review_title:reviewValue.reviewTitle,review_content:reviewValue.reviewContent,review_rating:ratingValue,book_id:id};try{const res=await axios.post(\"\".concat(API_URL,\"/api/review\"),reviewData);navigate('/mypage');}catch(error){const{reLogin}=errHandler(error);if(reLogin===true){setIslogin(false);}}};const handleClose=()=>{navigate('/mypage');};const handleInputChange=e=>{const{name,value}=e.target;setReviewValue(prevData=>({...prevData,[name]:value}));};return/*#__PURE__*/_jsxs(\"div\",{className:\"reivew-container-kjh\",children:[/*#__PURE__*/_jsx(\"img\",{src:API_URL+book.book_img_url}),/*#__PURE__*/_jsxs(\"h2\",{children:[\"\\uCC45 \\uC81C\\uBAA9 : \",book.book_name]}),/*#__PURE__*/_jsxs(\"form\",{className:\"review-form-kjh\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"\",children:\"\\uC81C\\uBAA9 : \"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"reviewTitle\",value:reviewValue.reviewTitle,onChange:handleInputChange}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"\",children:\"\\uB0B4\\uC6A9 : \"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"reviewContent\",value:reviewValue.reviewContent,onChange:handleInputChange}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"\",children:\"\\uBCC4\\uC810 : \"}),/*#__PURE__*/_jsx(BasicRating,{ratingValue:ratingValue,setRatingValue:setRatingValue})]}),/*#__PURE__*/_jsx(\"button\",{className:\"review_button-kjh\",type:\"submit\",onClick:handleSubmit,children:\"\\uC644\\uB8CC\"}),/*#__PURE__*/_jsx(\"button\",{className:\"review_cancell-kjh\",type:\"button\",onClick:handleClose,children:\"\\uCDE8\\uC18C\"})]});};export default Review;","map":{"version":3,"names":["React","useState","useEffect","axios","NavLink","useParams","useNavigate","API_URL","BasicRating","errHandler","useRecoilState","loginState","jsx","_jsx","jsxs","_jsxs","Review","navigate","islogin","setIslogin","id","book","setBook","reviewValue","setReviewValue","reviewTitle","reviewContent","ratingValue","setRatingValue","get","concat","then","res","console","log","data","catch","err","error","handleSubmit","reviewData","review_title","review_content","review_rating","book_id","post","reLogin","handleClose","handleInputChange","e","name","value","target","prevData","className","children","src","book_img_url","book_name","htmlFor","type","onChange","onClick"],"sources":["C:/Users/user/Desktop/Library-ec2/client/src/pages/Mypage/Review/Review.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport './Review.scss';\r\nimport axios from 'axios';\r\nimport { NavLink, useParams, useNavigate } from 'react-router-dom';\r\nimport { API_URL } from '../../../config/contansts';\r\nimport BasicRating from '../../../components/Rating/BasicRating';\r\nimport { errHandler } from \"../../../utils/globalFunction\";\r\nimport { useRecoilState } from \"recoil\";\r\nimport { loginState } from \"../../../recoil/atoms/State\";\r\n\r\n\r\nconst Review = () => {\r\n  const navigate = useNavigate();\r\n  const [islogin, setIslogin] = useRecoilState(loginState); //useState와 거의 비슷한 사용법\r\n  const { id } = useParams();\r\n  const [book, setBook] = useState({});\r\n  const [reviewValue, setReviewValue] = useState({\r\n    reviewTitle: '',\r\n    reviewContent: '',\r\n  });\r\n  const [ratingValue, setRatingValue] = useState(0);\r\n\r\n\r\n  useEffect(() => {\r\n    axios.get(`${API_URL}/api/book?book_id=${id}`)\r\n    .then(res => {\r\n      console.log(\"setBook : \", res.data[0]);\r\n      setBook(res.data[0]);\r\n    })\r\n    .catch((err) => {\r\n      console.error(err);\r\n    });\r\n  }, []);\r\n\r\n  const handleSubmit = async () => {\r\n    console.log(\"reviewValue : \", reviewValue);\r\n    console.log(\"ratingValue : \", ratingValue);\r\n    const reviewData = {\r\n      review_title: reviewValue.reviewTitle,\r\n      review_content: reviewValue.reviewContent,\r\n      review_rating: ratingValue,\r\n      book_id: id,\r\n    }\r\n    try {\r\n      const res = await axios.post(`${API_URL}/api/review`, reviewData);\r\n      navigate('/mypage');\r\n      \r\n    } catch (error) {\r\n      const {reLogin} = errHandler(error);\r\n      if (reLogin === true) {\r\n        setIslogin(false);\r\n      }\r\n    }\r\n  }\r\n\r\n  const handleClose = () => {\r\n    navigate('/mypage');\r\n  }\r\n\r\n  const handleInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setReviewValue((prevData) => ({\r\n      ...prevData,\r\n      [name]: value,\r\n    }));\r\n  };\r\n\r\n  return (\r\n    <div className='reivew-container-kjh'>\r\n      <img src={API_URL+book.book_img_url}></img>\r\n      <h2>책 제목 : {book.book_name}</h2>\r\n      <form className='review-form-kjh'>\r\n        <label htmlFor=\"\">제목 : </label>\r\n        <input \r\n          type='text'\r\n          name='reviewTitle'\r\n          value={reviewValue.reviewTitle}\r\n          onChange={handleInputChange}\r\n          />\r\n        <label htmlFor=\"\">내용 : </label>\r\n        <textarea \r\n          name='reviewContent'\r\n          value={reviewValue.reviewContent}\r\n          onChange={handleInputChange}\r\n        />\r\n        <label htmlFor=\"\">별점 : </label>\r\n        <BasicRating\r\n          ratingValue = {ratingValue}\r\n          setRatingValue = {setRatingValue}\r\n        />\r\n      </form>\r\n      <button className='review_button-kjh' type='submit' onClick={handleSubmit}>완료</button>\r\n      <button className='review_cancell-kjh' type='button' onClick={handleClose}>취소</button>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nexport default Review;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}