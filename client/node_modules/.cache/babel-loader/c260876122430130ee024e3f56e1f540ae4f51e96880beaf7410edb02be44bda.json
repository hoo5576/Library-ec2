{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{PieChart,Pie,Cell,Legend,Tooltip}from\"recharts\";import AMap from\"./AMap\";import AChart2 from\"./AChart2\";import ACalendar from\"./ACalendar\";import\"./A.scss\";import axios from\"axios\";import{API_URL}from\"../../../config/contansts\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const AChart=()=>{const[chartData,setChartData]=useState([]);useEffect(()=>{fetchchartData();},[]);const fetchchartData=()=>{axios.get(\"\".concat(API_URL,\"/api/loans\")).then(res=>{const loanData=res.data;console.log(loanData);const genreData=loanData.map(loan=>{const bookId=loan.book_id;console.log(bookId);let genre;if(bookId>=1&&bookId<=20){genre=\"총류\";}else if(bookId>=21&&bookId<=40){genre=\"사회과학\";}else if(bookId>=41&&bookId<=60){genre=\"문학\";}else if(bookId>=61&&bookId<=80){genre=\"예술\";}else if(bookId>=81&&bookId<=100){genre=\"종교\";}else if(bookId>=101&&bookId<=120){genre=\"철학\";}else if(bookId>=121&&bookId<=140){genre=\"기술과학\";}else if(bookId>=141&&bookId<=160){genre=\"자연과학\";}else if(bookId>=161&&bookId<=180){genre=\"언어\";}else if(bookId>=181&&bookId<=210){genre=\"역사\";}else{genre=\"기타\";}return{...loan,genre};});const groupedData=genreData.reduce((result,item)=>{const{genre,count=0}=item;result[genre]=(result[genre]||0)+1;return result;},{});const COLORS=[\"#0088FE\",\"#00C49F\",\"#FFBB28\",\"#FF8042\",\"#8A2BE2\"];const chartData=Object.keys(groupedData).map((genre,index)=>({book_id:genre,value:groupedData[genre],color:COLORS[index%COLORS.length]}));console.log(chartData);setChartData(chartData);}).catch(err=>{console.error(err);});};const COLORS=[\"#0088FE\",\"#00C49F\",\"#FFBB28\",\"#FF8042\",\"#8A2BE2\"];return/*#__PURE__*/_jsxs(\"div\",{className:\"a-chart-container-kjn\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chart-section-kjn\",children:[chartData.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"chart-none-kjn\",children:[\"\\uC774 \\uCC28\\uD2B8\\uC5D0 \\uD45C\\uC2DC\\uD560 \\uB370\\uC774\\uD130\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\",/*#__PURE__*/_jsx(\"br\",{}),\"\\uC0C8\\uB85C\\uC6B4 \\uB370\\uC774\\uD130\\uB97C \\uB4F1\\uB85D\\uD558\\uC5EC \\uCC28\\uD2B8\\uB97C \\uD655\\uC778\\uD558\\uC138\\uC694.\"]}):/*#__PURE__*/_jsxs(PieChart,{width:500,height:300,children:[/*#__PURE__*/_jsx(Pie,{dataKey:\"value\",data:chartData,cx:250,cy:150,outerRadius:80,fill:\"#8884d8\",label:entry=>entry.book_id,children:chartData.map((entry,index)=>/*#__PURE__*/_jsx(Cell,{fill:COLORS[index%COLORS.length]},\"cell-\".concat(index)))}),/*#__PURE__*/_jsx(Tooltip,{formatter:(value,name,props)=>[\"\".concat(props.payload.book_id,\": \").concat(value)]}),/*#__PURE__*/_jsx(Legend,{payload:chartData.map((entry,index)=>({value:entry.book_id,type:\"circle\",id:index,color:entry.color}))})]}),/*#__PURE__*/_jsx(AMap,{})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bottom-section-kjn\",children:[/*#__PURE__*/_jsx(AChart2,{}),/*#__PURE__*/_jsx(ACalendar,{})]})]});};export default AChart;","map":{"version":3,"names":["React","useState","useEffect","PieChart","Pie","Cell","Legend","Tooltip","AMap","AChart2","ACalendar","axios","API_URL","jsx","_jsx","jsxs","_jsxs","AChart","chartData","setChartData","fetchchartData","get","concat","then","res","loanData","data","console","log","genreData","map","loan","bookId","book_id","genre","groupedData","reduce","result","item","count","COLORS","Object","keys","index","value","color","length","catch","err","error","className","children","width","height","dataKey","cx","cy","outerRadius","fill","label","entry","formatter","name","props","payload","type","id"],"sources":["C:/Users/user/Desktop/Library-ec2/client/src/pages/Admin/AComponent/AChart.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { PieChart, Pie, Cell, Legend, Tooltip } from \"recharts\";\r\nimport AMap from \"./AMap\";\r\nimport AChart2 from \"./AChart2\";\r\nimport ACalendar from \"./ACalendar\";\r\nimport \"./A.scss\";\r\nimport axios from \"axios\";\r\nimport { API_URL } from \"../../../config/contansts\";\r\n\r\nconst AChart = () => {\r\n  const [chartData, setChartData] = useState([]);\r\n\r\n  useEffect(() => {\r\n    fetchchartData();\r\n  }, []);\r\n\r\n  const fetchchartData = () => {\r\n    axios\r\n      .get(`${API_URL}/api/loans`)\r\n      .then((res) => {\r\n        const loanData = res.data;\r\n        console.log(loanData);\r\n\r\n        const genreData = loanData.map((loan) => {\r\n          const bookId = loan.book_id;\r\n          console.log(bookId);\r\n          let genre;\r\n\r\n          if (bookId >= 1 && bookId <= 20) {\r\n            genre = \"총류\";\r\n          } else if (bookId >= 21 && bookId <= 40) {\r\n            genre = \"사회과학\";\r\n          } else if (bookId >= 41 && bookId <= 60) {\r\n            genre = \"문학\";\r\n          } else if (bookId >= 61 && bookId <= 80) {\r\n            genre = \"예술\";\r\n          } else if (bookId >= 81 && bookId <= 100) {\r\n            genre = \"종교\";\r\n          } else if (bookId >= 101 && bookId <= 120) {\r\n            genre = \"철학\";\r\n          } else if (bookId >= 121 && bookId <= 140) {\r\n            genre = \"기술과학\";\r\n          } else if (bookId >= 141 && bookId <= 160) {\r\n            genre = \"자연과학\";\r\n          } else if (bookId >= 161 && bookId <= 180) {\r\n            genre = \"언어\";\r\n          } else if (bookId >= 181 && bookId <= 210) {\r\n            genre = \"역사\";\r\n          } else {\r\n            genre = \"기타\";\r\n          }\r\n          return { ...loan, genre };\r\n        });\r\n\r\n        const groupedData = genreData.reduce((result, item) => {\r\n          const { genre, count = 0 } = item;\r\n          result[genre] = (result[genre] || 0) + 1;\r\n          return result;\r\n        }, {});\r\n\r\n        const COLORS = [\"#0088FE\", \"#00C49F\", \"#FFBB28\", \"#FF8042\", \"#8A2BE2\"];\r\n\r\n        const chartData = Object.keys(groupedData).map((genre, index) => ({\r\n          book_id: genre,\r\n          value: groupedData[genre],\r\n          color: COLORS[index % COLORS.length],\r\n        }));\r\n        console.log(chartData);\r\n\r\n        setChartData(chartData);\r\n      })\r\n      .catch((err) => {\r\n        console.error(err);\r\n      });\r\n  };\r\n\r\n  const COLORS = [\"#0088FE\", \"#00C49F\", \"#FFBB28\", \"#FF8042\", \"#8A2BE2\"];\r\n\r\n  return (\r\n    <div className=\"a-chart-container-kjn\">\r\n      <div className=\"chart-section-kjn\">\r\n        {chartData.length === 0 ? (\r\n          <div className=\"chart-none-kjn\">\r\n            이 차트에 표시할 데이터가 없습니다.\r\n            <br />\r\n            새로운 데이터를 등록하여 차트를 확인하세요.\r\n          </div>\r\n        ) : (\r\n          <PieChart width={500} height={300}>\r\n            <Pie\r\n              dataKey=\"value\"\r\n              data={chartData}\r\n              cx={250}\r\n              cy={150}\r\n              outerRadius={80}\r\n              fill=\"#8884d8\"\r\n              label={(entry) => entry.book_id}\r\n            >\r\n              {chartData.map((entry, index) => (\r\n                <Cell\r\n                  key={`cell-${index}`}\r\n                  fill={COLORS[index % COLORS.length]}\r\n                />\r\n              ))}\r\n            </Pie>\r\n            <Tooltip\r\n              formatter={(value, name, props) => [\r\n                `${props.payload.book_id}: ${value}`,\r\n              ]}\r\n            />\r\n            <Legend\r\n              payload={chartData.map((entry, index) => ({\r\n                value: entry.book_id,\r\n                type: \"circle\",\r\n                id: index,\r\n                color: entry.color,\r\n              }))}\r\n            />\r\n          </PieChart>\r\n        )}\r\n        <AMap />\r\n      </div>\r\n      <div className=\"bottom-section-kjn\">\r\n        <AChart2 />\r\n        <ACalendar />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AChart;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}